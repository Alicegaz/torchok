data:
  train:
    - dataset:
        name: TrainDataset
        transform:
        - name: OneOf
          params:
            transforms:
              - name: Blur
                params:
                  blur_limit: 11
              - name: RandomCrop
                params:
                  width: 224
                  height: 224
      dataloader:
        batch_size: 8
        num_workers: 4
        drop_last: True
        shuffle: True
      
optimization:
  - optimizer:
      name: Adam
      params:
        lr: 0.0001
        weight_decay: 1e-4
    scheduler:
      name: OneCycleLR
      params:
        max_lr: 0.001
        total_steps: 100000
      pl_params:
        interval: step

losses:
  loss_params:
    - name: SmoothL1Loss
      params:
        beta: 0.5
      tag: representation
      mapping:
        input: emb_student
        target: emb_teacher
      weight: 0.3
      
    - name: CrossEntropyLoss
      tag: classification
      mapping:
        input: logist
        target: target
      weight: 0.7

  normalize_weights: False
  
metrics:
  - name: Accuracy
    mapping: 
      input: logits
      target: target
    prefix: Cls
    phases: [train]